---
phase: 02-web-interface
plan: 02
type: execute
wave: 2
depends_on: ["02-01"]
files_modified:
  - frontend/components/RecipeInput.tsx
  - frontend/components/LoadingState.tsx
  - frontend/app/page.tsx
autonomous: true

must_haves:
  truths:
    - "User can paste text into input and see it appear"
    - "Input auto-grows as content increases"
    - "Submit button is disabled when input is too short"
    - "Full-page loading state appears after submission"
    - "Error message appears inline if API fails"
  artifacts:
    - path: "frontend/components/RecipeInput.tsx"
      provides: "Auto-growing textarea with submit"
      min_lines: 40
    - path: "frontend/components/LoadingState.tsx"
      provides: "Centered spinner with message"
      min_lines: 10
    - path: "frontend/app/page.tsx"
      provides: "Home page orchestrating input flow"
      min_lines: 30
  key_links:
    - from: "frontend/components/RecipeInput.tsx"
      to: "frontend/app/page.tsx"
      via: "onSubmit callback prop"
      pattern: "onSubmit.*transcript"
    - from: "frontend/app/page.tsx"
      to: "frontend/lib/api.ts"
      via: "parseRecipe import"
      pattern: "import.*parseRecipe.*from.*lib/api"
---

<objective>
Build the input page with chat-style auto-growing textarea, submit flow, and loading state.

Purpose: Entry point for users - paste transcript, submit, see loading while API processes.
Output: Working input -> loading -> success/error flow (recipe display comes in Plan 03).
</objective>

<execution_context>
@/Users/bharadwajkulkarni/.claude/get-shit-done/workflows/execute-plan.md
@/Users/bharadwajkulkarni/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/phases/02-web-interface/02-CONTEXT.md
@.planning/phases/02-web-interface/02-RESEARCH.md
@frontend/lib/api.ts
@frontend/lib/types.ts
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create RecipeInput component with auto-grow textarea</name>
  <files>frontend/components/RecipeInput.tsx</files>
  <action>
    Create chat-style input component with auto-growing textarea.

    Props:
    - onSubmit: (transcript: string) => void
    - disabled?: boolean (optional, for blocking during loading)
    - error?: string (optional, for displaying inline errors)

    Implementation:
    1. Use CSS Grid technique for auto-grow (from RESEARCH.md):
       - Outer div with grid class and data-cloned-val attribute
       - After pseudo-element mirrors content: `after:invisible after:whitespace-pre-wrap after:content-[attr(data-cloned-val)_'_']`
       - Textarea overlays same grid area: `[grid-area:1/1/2/2]`
       - Both elements need matching padding and font-size

    2. Textarea styling:
       - Background: bg-[#2d2d2d]
       - Text: text-white text-lg (large for readability)
       - Rounded corners: rounded-xl
       - Padding: px-4 py-3
       - Focus ring: focus:outline-none focus:ring-2 focus:ring-[#39FF6D]
       - Placeholder: "Paste or dictate your recipe here..."
       - resize-none overflow-hidden

    3. Submit behavior:
       - Enter key submits (e.key === 'Enter' && !e.shiftKey), call e.preventDefault() then submit
       - Shift+Enter adds newline (do nothing, let default behavior)
       - Submit button below textarea
       - Button disabled if transcript.trim().length < 10
       - Button styling: bg-[#39FF6D] text-black font-semibold rounded-xl py-3
       - Disabled state: opacity-50 cursor-not-allowed
       - Hover: hover:bg-[#2dd15f] (slightly darker green)

    4. Error display:
       - If error prop provided, show below textarea
       - Red text: text-red-400
       - Small margin-top

    Mark as 'use client' at top (client component).
  </action>
  <verify>
    cd frontend && npx tsc --noEmit
    No type errors on component.
  </verify>
  <done>
    - Textarea auto-grows with content
    - Enter submits, Shift+Enter adds newline
    - Submit button disabled when input too short
    - Error displays inline when provided
    - Dark theme styling with neon green accent
  </done>
</task>

<task type="auto">
  <name>Task 2: Create LoadingState component</name>
  <files>frontend/components/LoadingState.tsx</files>
  <action>
    Create full-page loading overlay shown during API processing.

    Props:
    - message: string (e.g., "Parsing your recipe...")

    Implementation:
    1. Fixed position covering viewport: fixed inset-0
    2. Dark background matching app: bg-[#1a1a1a]
    3. Flex centered content: flex flex-col items-center justify-center
    4. Spinner:
       - Use div with animate-spin
       - Size: h-12 w-12
       - Border: border-4 border-[#39FF6D] border-t-transparent
       - Rounded: rounded-full
    5. Message below spinner:
       - mt-4 text-white text-lg
       - Display the message prop

    Mark as 'use client' at top.
  </action>
  <verify>
    cd frontend && npx tsc --noEmit
    No type errors.
  </verify>
  <done>
    - Full-page dark overlay with centered spinner
    - Neon green spinner with animation
    - Message displayed below spinner
  </done>
</task>

<task type="auto">
  <name>Task 3: Wire up home page with input, loading, and API flow</name>
  <files>frontend/app/page.tsx</files>
  <action>
    Replace placeholder page with full input flow.

    State:
    - transcript: string (what user typed)
    - isLoading: boolean
    - error: string | null
    - recipe: Recipe | null (for passing to next plan's component)

    Flow:
    1. Show RecipeInput when !isLoading and !recipe
    2. Show LoadingState when isLoading
    3. (Recipe display will be added in Plan 03)
    4. For now, on successful parse, just store recipe in state and log it

    handleSubmit function:
    1. Set isLoading true, error null
    2. try: const recipe = await parseRecipe(transcript)
    3. Set recipe state (component placeholder until Plan 03)
    4. catch: Set error to error.message
    5. finally: Set isLoading false

    Layout:
    - Container: min-h-screen flex flex-col
    - When showing input:
      - Centered vertically: flex-1 flex flex-col justify-center
      - Max width container: max-w-2xl mx-auto w-full px-4
      - Title above input: "Recipe Checklist" as h1, text-3xl font-bold text-white mb-8 text-center
    - When showing recipe (placeholder for now):
      - Just show "Recipe loaded!" with recipe.title

    Mark as 'use client' at top.
  </action>
  <verify>
    cd frontend && npm run build
    Build succeeds.

    Manual: Run npm run dev, paste text, see loading state appear.
  </verify>
  <done>
    - Home page shows centered input with title
    - Submitting shows loading state
    - API errors display inline below input
    - Successful parse stores recipe (ready for Plan 03)
  </done>
</task>

</tasks>

<verification>
1. `cd frontend && npm run build` succeeds
2. `npm run dev` shows home page with input
3. Typing in textarea shows auto-grow behavior
4. Submitting triggers loading state
5. (API call will work once Cloudflare Worker is running locally)
</verification>

<success_criteria>
- WEB-01: Home page with text input - DONE
- WEB-02: Submit button triggers parse API - DONE
- WEB-07: Loading state while API processes - DONE
- DES-04: Dark theme with neon green accent - DONE
- DES-05: Minimal chrome, focus on content - DONE
</success_criteria>

<output>
After completion, create `.planning/phases/02-web-interface/02-02-SUMMARY.md`
</output>
