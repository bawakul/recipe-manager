---
phase: 02-web-interface
plan: 04
type: execute
wave: 3
depends_on: ["02-02", "02-03"]
files_modified:
  - frontend/app/page.tsx
  - frontend/components/AdjustPanel.tsx
autonomous: true

must_haves:
  truths:
    - "Successful parse shows recipe checklist"
    - "User can click 'Start over' to return to input"
    - "Adjust button opens panel with original transcript"
    - "User can submit adjustment and get updated recipe"
  artifacts:
    - path: "frontend/app/page.tsx"
      provides: "Complete page flow with all states"
      min_lines: 80
    - path: "frontend/components/AdjustPanel.tsx"
      provides: "Side panel for recipe corrections"
      min_lines: 40
  key_links:
    - from: "frontend/app/page.tsx"
      to: "frontend/components/RecipeChecklist.tsx"
      via: "Recipe display integration"
      pattern: "RecipeChecklist.*recipe"
    - from: "frontend/components/AdjustPanel.tsx"
      to: "frontend/lib/api.ts"
      via: "parseRecipe for re-parsing"
      pattern: "parseRecipe"
---

<objective>
Wire up complete page flow: input -> loading -> checklist -> adjust. Integrate all components.

Purpose: Complete the user journey from transcript to usable checklist with ability to refine.
Output: Full working web interface with all features integrated.
</objective>

<execution_context>
@/Users/bharadwajkulkarni/.claude/get-shit-done/workflows/execute-plan.md
@/Users/bharadwajkulkarni/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/phases/02-web-interface/02-CONTEXT.md
@frontend/components/RecipeInput.tsx
@frontend/components/LoadingState.tsx
@frontend/components/RecipeChecklist.tsx
@frontend/components/ProgressBar.tsx
@frontend/lib/api.ts
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create AdjustPanel component</name>
  <files>frontend/components/AdjustPanel.tsx</files>
  <action>
    Create side panel for adjusting/refining the parsed recipe.

    Props:
    - isOpen: boolean
    - onClose: () => void
    - originalTranscript: string
    - onAdjust: (newTranscript: string) => void

    State:
    - adjustmentText: string (new corrections to add)
    - isSubmitting: boolean (for loading state)

    Implementation:

    1. Overlay when open:
       - fixed inset-0 z-50
       - Click outside to close: bg-black/50 layer that calls onClose

    2. Panel slides in from right:
       - fixed right-0 top-0 h-full w-full md:w-96
       - bg-[#1a1a1a] border-l border-[#2d2d2d]
       - Transform: translate-x-0 when open, translate-x-full when closed
       - transition-transform duration-300

    3. Panel header:
       - Flex row with "Adjust Recipe" title and X close button
       - Padding: p-4
       - Border bottom: border-b border-[#2d2d2d]

    4. Original transcript display:
       - Label: "Original transcript" in text-sm text-gray-400 mb-2
       - Scrollable container: max-h-48 overflow-y-auto
       - Text: text-gray-300 text-sm whitespace-pre-wrap bg-[#2d2d2d] p-3 rounded-lg

    5. Adjustment input:
       - Label: "Add corrections or changes" in text-sm text-gray-400 mb-2 mt-4
       - Textarea (not auto-grow, fixed height is fine here):
         - bg-[#2d2d2d] text-white rounded-lg p-3
         - rows={4}
         - Placeholder: "e.g., 'Actually use 2 chicken breasts, not thighs' or 'Add a step to preheat oven to 400F'"

    6. Submit button:
       - Full width: w-full mt-4
       - Same styling as main submit: bg-[#39FF6D] text-black font-semibold rounded-xl py-3
       - Text: "Re-parse with changes"
       - Disabled when adjustmentText is empty or isSubmitting
       - Show spinner when isSubmitting

    7. onSubmit behavior:
       - Combine: originalTranscript + "\n\nADJUSTMENTS:\n" + adjustmentText
       - Call onAdjust(combinedText)
       - Parent handles the actual API call

    Mark as 'use client' at top.
  </action>
  <verify>
    cd frontend && npx tsc --noEmit
  </verify>
  <done>
    - Panel slides in from right
    - Shows original transcript
    - Allows entering corrections
    - Submit combines and calls parent handler
  </done>
</task>

<task type="auto">
  <name>Task 2: Complete page.tsx with full flow integration</name>
  <files>frontend/app/page.tsx</files>
  <action>
    Update page.tsx to integrate all components and handle complete flow.

    State:
    - transcript: string (current/original transcript)
    - recipe: Recipe | null
    - isLoading: boolean
    - error: string | null
    - isAdjustPanelOpen: boolean

    Views (conditional rendering):

    1. Loading state (isLoading === true):
       - Show LoadingState with "Parsing your recipe..."

    2. Input state (recipe === null && !isLoading):
       - Centered layout: min-h-screen flex items-center justify-center
       - Container: max-w-2xl w-full px-4
       - Title: "Recipe Checklist" h1, text-3xl font-bold text-white text-center mb-8
       - RecipeInput component with onSubmit and error prop

    3. Recipe state (recipe !== null):
       - Full-page scrollable layout
       - Header bar (fixed or sticky):
         - Container with flex justify-between items-center
         - Recipe title on left (or just show in checklist)
         - Action buttons on right: "Adjust" and "Start over"
       - RecipeChecklist below header
       - AdjustPanel (conditionally open)

    Handler functions:

    1. handleSubmit(newTranscript: string):
       - Store transcript in state (for adjust panel)
       - Set isLoading true, error null
       - try: recipe = await parseRecipe(newTranscript)
       - Set recipe state
       - catch: Set error message
       - finally: Set isLoading false

    2. handleStartOver():
       - Set recipe null
       - Set transcript ''
       - Set error null
       - Clear localStorage for current recipe (optional - can leave for return visits)

    3. handleAdjust(combinedTranscript: string):
       - Close adjust panel
       - Call handleSubmit with combined transcript

    Button styling for header actions:
    - "Adjust" button: border border-[#39FF6D] text-[#39FF6D] px-4 py-2 rounded-lg hover:bg-[#39FF6D]/10
    - "Start over" button: text-gray-400 hover:text-white px-4 py-2

    Layout considerations:
    - When showing recipe, remove the centered flex so content can scroll naturally
    - Add proper padding for mobile: px-4
    - Header should be at top, not fixed (simple for hackathon)
  </action>
  <verify>
    cd frontend && npm run build
    Build succeeds.
  </verify>
  <done>
    - Complete flow: input -> loading -> checklist
    - "Start over" returns to input
    - "Adjust" opens panel
    - Adjustment re-parses with combined transcript
    - All components integrated and working
  </done>
</task>

</tasks>

<verification>
1. `cd frontend && npm run build` succeeds
2. `npm run dev` shows complete flow
3. Can paste transcript, see loading, see checklist
4. Can check off steps and see progress update
5. Can click "Adjust" to open panel
6. Can click "Start over" to return to input
</verification>

<success_criteria>
All Phase 2 requirements complete:
- WEB-01: Home page with text input - DONE
- WEB-02: Submit triggers parse API - DONE
- WEB-03: Recipe renders as checklist - DONE
- WEB-04: Progress bar shows completion - DONE
- WEB-05: Sections collapsible - SKIPPED (CONTEXT.md override)
- WEB-06: Checkbox persists in localStorage - DONE
- WEB-07: Loading state - DONE
- DES-01: Mobile-first - DONE
- DES-02: Large tap targets - DONE
- DES-03: High contrast - DONE
- DES-04: Dark theme with neon green - DONE
- DES-05: Minimal chrome - DONE
</success_criteria>

<output>
After completion, create `.planning/phases/02-web-interface/02-04-SUMMARY.md`
</output>
