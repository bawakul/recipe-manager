---
phase: 02-web-interface
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - frontend/package.json
  - frontend/tsconfig.json
  - frontend/app/layout.tsx
  - frontend/app/globals.css
  - frontend/lib/types.ts
  - frontend/lib/api.ts
autonomous: true

must_haves:
  truths:
    - "Next.js project builds without errors"
    - "TypeScript types match Cloudflare Worker Recipe schema"
    - "API client can call /api/recipe/parse endpoint"
  artifacts:
    - path: "frontend/package.json"
      provides: "Next.js dependencies"
      contains: "next"
    - path: "frontend/lib/types.ts"
      provides: "Recipe, Section, Step, Ingredient types"
      exports: ["Recipe", "Section", "Step", "Ingredient"]
    - path: "frontend/lib/api.ts"
      provides: "API client for Cloudflare Worker"
      exports: ["parseRecipe"]
    - path: "frontend/app/layout.tsx"
      provides: "Root layout with dark theme"
      contains: "bg-[#1a1a1a]"
  key_links:
    - from: "frontend/lib/types.ts"
      to: "src/types.ts (Cloudflare Worker)"
      via: "Manual type mirroring"
      pattern: "Recipe.*Section.*Step.*Ingredient"
    - from: "frontend/lib/api.ts"
      to: "NEXT_PUBLIC_API_URL"
      via: "Environment variable"
      pattern: "process.env.NEXT_PUBLIC_API_URL"
---

<objective>
Set up Next.js frontend project with TypeScript, Tailwind CSS, dark theme, and API client.

Purpose: Foundation for all web UI - types, styling, and API connectivity must be solid before building components.
Output: Buildable Next.js project with shared types and working API client.
</objective>

<execution_context>
@/Users/bharadwajkulkarni/.claude/get-shit-done/workflows/execute-plan.md
@/Users/bharadwajkulkarni/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/02-web-interface/02-CONTEXT.md
@.planning/phases/02-web-interface/02-RESEARCH.md
@.planning/phases/01-foundation/01-01-SUMMARY.md
@src/types.ts
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create Next.js project with TypeScript and Tailwind</name>
  <files>
    frontend/package.json
    frontend/tsconfig.json
    frontend/app/layout.tsx
    frontend/app/page.tsx
    frontend/app/globals.css
    frontend/.env.local
    frontend/.env.example
  </files>
  <action>
    Create Next.js project in `frontend/` directory using create-next-app:
    - Use App Router (not pages)
    - Enable TypeScript
    - Enable Tailwind CSS
    - Use default ESLint config
    - No src directory (app/ at root)

    After scaffolding:
    1. Update `app/layout.tsx`:
       - Set html className to include "dark" for Tailwind dark mode
       - Set body className to "bg-[#1a1a1a] text-white min-h-screen"
       - Update metadata title to "Recipe Checklist"

    2. Update `app/globals.css`:
       - Keep Tailwind imports (@tailwind base, components, utilities)
       - Remove all default CSS except Tailwind directives

    3. Update `app/page.tsx`:
       - Replace with minimal placeholder: just a centered "Recipe Checklist" h1
       - Apply text-white and text-2xl classes

    4. Create `.env.local`:
       - Add NEXT_PUBLIC_API_URL=http://localhost:8787

    5. Create `.env.example`:
       - Add NEXT_PUBLIC_API_URL=http://localhost:8787 (for documentation)

    Run from project root, not from frontend directory.
  </action>
  <verify>
    cd frontend && npm run build
    Should complete without errors.
  </verify>
  <done>
    - Next.js project exists in frontend/ directory
    - npm run build succeeds
    - Dark theme (#1a1a1a) applied to body
    - Environment variables configured for local API
  </done>
</task>

<task type="auto">
  <name>Task 2: Create shared types and API client</name>
  <files>
    frontend/lib/types.ts
    frontend/lib/api.ts
    frontend/lib/storage.ts
  </files>
  <action>
    1. Create `frontend/lib/types.ts`:
       - Mirror the Recipe types from `src/types.ts` (Cloudflare Worker)
       - Export: Step, Ingredient, Section, Recipe interfaces
       - DO NOT use Zod here (frontend doesn't need validation)
       - Section.name is union type: 'Prep' | 'Marinate' | 'Cook' | 'Assemble'
       - Step has: id (string), text (string), completed (boolean)
       - Ingredient has: name (string), quantity? (string), notes? (string)
       - Recipe has: title (string), sections (Section[]), ingredients (Ingredient[])

    2. Create `frontend/lib/api.ts`:
       - Export RecipeAPIError class extending Error (status: number, message: string)
       - Export async function parseRecipe(transcript: string): Promise<Recipe>
       - Read API_URL from process.env.NEXT_PUBLIC_API_URL, default to 'http://localhost:8787'
       - POST to ${API_URL}/api/recipe/parse with JSON body { transcript }
       - Handle errors: if !response.ok, parse error JSON and throw RecipeAPIError
       - Return parsed Recipe on success

    3. Create `frontend/lib/storage.ts`:
       - Export useLocalStorage<T>(key: string, initialValue: T) hook
       - Use lazy useState initialization to avoid SSR hydration mismatch
       - Check typeof window !== 'undefined' before accessing localStorage
       - Wrap JSON.parse in try/catch, return initialValue and remove corrupted data on error
       - setValue should update both state and localStorage
       - Return [storedValue, setValue] as const
  </action>
  <verify>
    cd frontend && npx tsc --noEmit
    TypeScript should compile without errors.
  </verify>
  <done>
    - Types mirror Cloudflare Worker schema exactly
    - API client handles success and error cases
    - Storage hook is SSR-safe (no hydration errors)
  </done>
</task>

</tasks>

<verification>
1. `cd frontend && npm run build` completes without errors
2. `cd frontend && npx tsc --noEmit` has no type errors
3. `npm run dev` starts server and shows dark-themed page
4. .env.local exists with API URL
</verification>

<success_criteria>
- Next.js project builds successfully
- Dark theme (#1a1a1a) is visible when running dev server
- Types match src/types.ts schema (Recipe, Section, Step, Ingredient)
- API client ready to call Cloudflare Worker
- localStorage hook handles SSR safely
</success_criteria>

<output>
After completion, create `.planning/phases/02-web-interface/02-01-SUMMARY.md`
</output>
